  {
      "alias": "status_update",
      "name": "Status Update",
      "descriptor": {
        "type": "timeseries",
        "sizeX": 7,
        "sizeY": 5.5,
        "resources": [],
        "templateHtml": "<div class=\"card\">\n    <h6>STATUS UPDATES</h6>\n    <div class=\"outerBox\">\n        <div class=\"innerbox\" id=\"entityId\">\n            <!--<h7>09-06-2021 - 13:06:53 GENX003 has been\n                marked as\n                <br>'BREAKDOWN' by user Customer.Admin\n            </h7>-->\n        </div>\n    </div>\n\n    <div class=\"button\">\n        <button (click)=\"reportbreakDown()\">REPORT <br>BREAKDOWN</button>\n        <button (click)=\"inMaintenance()\">IN <br>MAINTENANCE</button>\n        <button (click)=\"inOpertaion()\">IN <br> OPERATION</button>\n    </div>\n\n</div>",
        "templateCss": "*{\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n}\n.card{\n    padding: 4px;\n    width: 100%;\n    height: 100%;\n    background: #e1e1e1;\n    display: flex;\n   \n   \n    flex-direction: column;\n}\n.innerbox{\n    padding: 3px;\n    width: 98%;\n    height: 95%;\n    background: #eee;\n    overflow: scroll;\n}\n.button{\n    padding: 4px;\n    width: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n}\n.button button{\n    font-size: 12px;\n    width: 30%;\n}\n.outerBox{\n    width: 100%;\n    height: 90%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\nh7{\n    font-size: 10px;\n}\n.border{\n    margin: 4px 0px ;\n    border-bottom: 1px solid #000;\n}",
        "controllerScript": "self.onInit = function() {\n    var $scope = self.ctx.$scope;\n    \n    var devid= self.ctx.data[0].datasource.entityId;\n    allLog(devid);\n    function allLog(devid){\n    //devid=devid.replace(/[^a-zA-Z0-9]/g,'');\n    //console.log(devid);\n    //console.log(self.ctx.data);\n      var XHR2 = new XMLHttpRequest();\n    \t\tXHR2.open(\"GET\", \"api/audit/logs/entity/DEVICE/\"+devid+\"?pageSize=10&page=0&sortProperty=createdTime&sortOrder=DESC&startTime=\"+(Date.now()-86400000)+\"&endTime=\"+(Date.now())+\"\");\n           //XHR2.open(\"GET\",\"api/plugins/telemetry/DEVICE/\"+devid+\"/values/attributes/SERVER_SCOPE\");\n            XHR2.setRequestHeader('X-Authorization','Bearer '+ localStorage.getItem(\"jwt_token\"));\n    \t\tXHR2.setRequestHeader(\"Content-Type\", \"application/json;charset=UTF-8\");\n\n\n    \tXHR2.onload = function() {\n    \t    console.log(JSON.parse(XHR2.responseText));  \n    \t    var result=JSON.parse(XHR2.responseText);\n    \t    //console.log(result.data[0].createdTime);\n    \tdocument.getElementById(\"entityId\").innerHTML=\"\";\n    \tfor(var key in result.data){\n    \t    var myDate = new Date( parseInt(result.data[key].createdTime));\n    \t    document.getElementById(\"entityId\").innerHTML+='<h7>'+myDate.toLocaleString()+','+result.data[key].entityName+'to state of'+result.data[key].actionData.attributes.Operational_Status+',updated by '+result.data[key].userName+'</h7><br>';\n    \t}\n    \t//console.log(result);\n        }\n    \tXHR2.send();\n    }\n    self.ctx.$scope.reportbreakDown=function() {\n            var devid= self.ctx.data[0].datasource.entityId;\n        //var url = \"https://thingsboard.cloud/api/v1/Q0aP5Ej0bJ3uyIEBwFZh/attributes\";\n        var url=\"/api/plugins/telemetry/DEVICE/\"+devid+\"/SERVER_SCOPE\";\n        var xhr = new XMLHttpRequest();\n        xhr.open(\"POST\", url);\n            xhr.setRequestHeader('X-Authorization','Bearer '+ localStorage.getItem(\"jwt_token\"));\n    \t\txhr.setRequestHeader(\"Content-Type\", \"application/json;charset=UTF-8\");\n\n       // xhr.setRequestHeader(\"Access-Control-Allow-Origin\",\"*\");\n        xhr.onreadystatechange = function() {\n            if (xhr.readyState === 4) {\n                console.log(xhr.status);\n                console.log(xhr.responseText);\n                allLog(devid);\n            }\n        };\n\n        var data = `{\n            \"Operational_Status\":\"reportbreakDown\"\n                }`;\n\n        xhr.send(data);\n        \n    }\n    self.ctx.$scope.inMaintenance= function() {\n        var devid= self.ctx.data[0].datasource.entityId;\n        //var url = \"https://thingsboard.cloud/api/v1/Q0aP5Ej0bJ3uyIEBwFZh/attributes\";\n        var url = \"api/plugins/telemetry/\"+devid+\"/SERVER_SCOPE\";\n        var xhr = new XMLHttpRequest();\n        xhr.open(\"POST\", url);\n            xhr.setRequestHeader('X-Authorization','Bearer '+ localStorage.getItem(\"jwt_token\"));\n    \t\txhr.setRequestHeader(\"Content-Type\", \"application/json;charset=UTF-8\");\n\n       // xhr.setRequestHeader(\"Access-Control-Allow-Origin\",\"*\");\n        xhr.onreadystatechange = function() {\n            if (xhr.readyState === 4) {\n                console.log(xhr.status);\n                console.log(xhr.responseText);\n                allLog(devid);\n            }\n        };\n\n        var data = `{\n            \"Operational_Status\":\"inMaintenance\"\n                }`;\n\n        xhr.send(data);\n    }\n    self.ctx.$scope.inOpertaion=function() {\n        var devid= self.ctx.data[0].datasource.entityId;\n        //var url = \"https://thingsboard.cloud/api/v1/Q0aP5Ej0bJ3uyIEBwFZh/attributes\";\n        var url=\"/api/plugins/telemetry/\"+devid+\"/SERVER_SCOPE\";\n        var xhr = new XMLHttpRequest();\n        xhr.open(\"POST\", url);\n\n        xhr.setRequestHeader('X-Authorization','Bearer '+ localStorage.getItem(\"jwt_token\"));\n    \txhr.setRequestHeader(\"Content-Type\", \"application/json;charset=UTF-8\");\n\n       // xhr.setRequestHeader(\"Access-Control-Allow-Origin\",\"*\");\n        xhr.onreadystatechange = function() {\n            if (xhr.readyState === 4) {\n                console.log(xhr.status);\n                console.log(xhr.responseText);\n                allLog(devid);\n            }\n        };\n\n        var data = `{\n            \"Operational_Status\":\"inOpertaion\"\n                }`;\n\n        xhr.send(data);\n    }\n}\n\n// self.actionSources = function() {\n//     return {\n//         'elementClick': {\n//             name: 'widget-action.element-click',\n//             multiple: true\n//         }\n//     };\n// }\n\n// self.onDestroy = function() {\n// }\n",
        "settingsSchema": "{\n    \"schema\": {\n        \"type\": \"object\",\n        \"title\": \"Settings\",\n        \"required\": [\"cardHtml\"],\n        \"properties\": {\n            \"cardCss\": {\n                \"title\": \"CSS\",\n                \"type\": \"string\",\n                \"default\": \".card {\\n font-weight: bold; \\n}\"\n            },\n            \"cardHtml\": {\n                \"title\": \"HTML\",\n                \"type\": \"string\",\n                \"default\": \"<div class='card'>HTML code here</div>\"\n            }\n        }\n    },\n    \"form\": [\n        {\n            \"key\": \"cardCss\",\n            \"type\": \"css\"\n        },           \n        {\n            \"key\": \"cardHtml\",\n            \"type\": \"html\"\n        }    \n    ]\n}",
        "dataKeySettingsSchema": "{}\n",
        "defaultConfig": "{\"showTitle\":false,\"backgroundColor\":\"rgb(255, 255, 255)\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"8px\",\"settings\":{\"cardHtml\":\"<div class='card'>HTML code here</div>\",\"cardCss\":\".card {\\n    font-weight: bold;\\n    font-size: 32px;\\n    color: #999;\\n    width: 100%;\\n    height: 100%;\\n    display: flex;\\n    align-items: center;\\n    justify-content: center;\\n}\"},\"title\":\"Status Update\",\"dropShadow\":true,\"timewindow\":{\"realtime\":{\"timewindowMs\":60000}},\"datasources\":[]}"
        },
      "image": null,
      "description": null
    }
  